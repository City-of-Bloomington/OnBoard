{#
 * @copyright 2024 City of Bloomington, Indiana
 * @license http://www.gnu.org/licenses/agpl.txt GNU/AGPL, see LICENSE
 * @param Committee committee
 * @param array     current_applications
 * @param array     archived_applications
 #}
{% extends "html/layouts/default.twig" %}
{% block content %}
{{ include('html/committees/breadcrumbs.twig') }}
<section>
    <header>
        <h2>{{ _(['application', 'applications', current_applications|length ]) }}
    </header>

    <table class="table">
    <thead>
        <tr><th>{{ _('created') }}</th>
            <th>{{ _('name'   ) }}</th>
            <th>{{ _('expires') }}</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% set userCanViewApplicant    = isAllowed('applicants',   'view')         %}
        {% set userCanArchive          = isAllowed('applications', 'archive')      %}
        {% set userCanUnArchive        = isAllowed('applications', 'unarchive')    %}
        {% set userCanDelete           = isAllowed('applications', 'delete')       %}

        {% for a in current_applications %}
        {% set p = a.getApplicant() %}
        <tr><td>{{ a.getCreated(DATE_FORMAT) }}</td>
            <td>{% if userCanViewApplicant %}
                <a href="{{ uri('applicants.view') }}?applicant_id={{ a.getApplicant_id() }}">
                    {{ p.getFirstname() }} {{ p.getLastname() }}
                </a>
                {% else %}
                {{ p.getFirstname() }} {{ p.getLastname() }}
                {% endif %}
            </td>
            <td>{{ a.getExpires(DATE_FORMAT) }}</td>
            <td>{% if userCanArchive %}
                <a class="btn btn-primary"
                    href="{{ uri('applications.archive') }}?application_id={{ a.getId() }}">
                    {{ _('application_archive') }}
                </a>
                {% endif %}

                {% if userCanDelete %}
                <a class="btn btn-primary"
                    href="{{ uri('applications.delete') }}?application_id={{ a.getId() }}">
                    {{ _('application_delete') }}
                </a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
    </table>
</section>

{{ include('html/applications/partials/archived_applications.twig') }}

{% endblock %}
